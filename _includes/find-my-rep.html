{% if include.title %}
  {% assign title = include.title %}
{% elsif include.text %}
  {% assign text = include.text %}
{% else %}
  {% assign title = 'legislator search' %}
{% endif %}
{% assign today_date = site.time | date: '%Y-%m-%d' %}


<div id="find-my-reps"></div>
<script>
  window.addEventListener("DOMContentLoaded", function() {

  var legislators = [
    {% for leg in site.legislators %}
      {%assign leg_end_date = leg.end_date | date: '%Y-%m-%d'%}
      {% unless leg_end_date != "" and leg_end_date < today_date %}
        {% assign district = site.data.cache.districts_by_id[leg.district] %}
        {% assign short_id = leg.id | replace: "/legislators/", "" %}
        {
          href: "{{leg.id}}",
          first_name: "{{leg.first_name}}",
          last_name: "{{leg.last_name}}",
          chamber: "{{leg.district | split: "-" | first }}",
        },
      {% endunless %}
    {% endfor %}
  ];

  var data = {
    title: "{{title}}",
    text: "{{text}}",
    theme: "{{include.theme}}",
    {% if include.bill %}
      bill: {{bill.json}},
    {% endif %}
    showResultIfEmpty: {% if include.showResultsIfEmpty == "true" %}true{% else %}false{% endif %},
    scripts: {% if include.bill %}{{site.data.default_bill_scripts | jsonify}}{% else %}{{site.data.pledge_scripts | jsonify}}{% endif %},
    legislators: legislators,
  };

    AOM.renderFindMyReps("find-my-reps", data);
  });
</script>
